<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>APersonalSite</title>
</head>

<body>
  <section class="section">
    <div class="container">
      
<h1 class="title">
  Cryptocurrency Mining Analytics Dashboard
</h1>
<p class="subtitle"><strong>2022-10-15</strong></p>
<p>I've been mining Etherium on my desktop PC for about a year now, using a Nvidia 1080 Ti I bought used for gaming. The income is modest, but is a good stream of <a href="https://en.wikipedia.org/wiki/Beer_money"><em>beer money</em></a>. Etherium is now moving towards a staking system, and so my mining era is concluded but it was a good run. </p>
<p>I've setup an analytics dashboard, and have been collecting metrics from the GPU and the mining pool since starting.</p>
<p>I wanted a better way to track costs related to power consumption, and calculate profitability. What started as a simple monitoring need turned into a full-fledged analytics pipeline that taught me a lot about data engineering and visualization.</p>
<p>The analytics stack runs on my home server, seperate from the mining PC.</p>
<p><img src="/images/crypto-mining-dashboard-system-diagram.png" alt="System Diagram" /></p>
<p>This tutorial walks through setting up the monitoring and analytics stack; Prometheus, Grafana, and exporters. Setting up Docker and mining software is out of scope for this tutorial.</p>
<h2 id="the-problem-and-initial-planning">The Problem and Initial Planning</h2>
<p>Mining operations generate data from multiple sources that don't naturally talk to each other. Your GPUs are reporting power consumption and temperatures through nvidia-smi, while your mining pool tracks hashrates and earnings on their web interface. </p>
<p>I needed a solution that could collect metrics from different sources, store them reliably, and present everything in dashboards that make sense for both quick health checks and deeper analysis. After evaluating several options, I settled on the Prometheus ecosystem because it's designed specifically for time-series monitoring and has excellent tooling around it.</p>
<p>The architecture ended up being fairly straightforward: exporters collect metrics and expose them via HTTP endpoints, Prometheus scrapes those endpoints and stores the data, and Grafana queries Prometheus to build dashboards. Docker Compose orchestrates everything and handles service discovery automatically.</p>
<h2 id="project-file-structure">Project File Structure</h2>
<p><strong>Server</strong></p>
<pre style="background-color:#ffffff;color:#4d4d4c;"><code><span>crypto-mining-dashboard/
</span><span>├── compose.yam
</span><span>├── prometheus/
</span><span>│   └── config/
</span><span>│       └── prometheus.yml
</span><span>├── grafana/
</span><span>│   └── config/
</span><span>│       └── datasources.yml
</span></code></pre>
<p><strong>Desktop</strong></p>
<pre style="background-color:#ffffff;color:#4d4d4c;"><code><span>data-exporters/
</span><span>├── compose.yaml
</span></code></pre>
<h2 id="building-the-data-pipeline">Building the Data Pipeline</h2>
<h3 id="prometheus-database">Prometheus Database</h3>
<p><em>&quot;<a href="https://prometheus.io/docs/introduction/overview/">Prometheus</a> is an open-source systems monitoring and alerting toolkit originally built at SoundCloud.&quot;</em></p>
<p><em>&quot;Prometheus collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels.&quot;</em></p>
<p>Prometheus is optimized for storing time-series data, meant to be used for streaming metrics and analytics. It's works will with Grafana.</p>
<p>The following is the <code>compose.yaml</code> file</p>
<pre data-lang="yaml" style="background-color:#ffffff;color:#4d4d4c;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#c82829;">services</span><span>:
</span><span>  </span><span style="color:#c82829;">prometheus</span><span>:
</span><span>    </span><span style="color:#c82829;">image</span><span>: </span><span style="color:#718c00;">prom/prometheus
</span><span>    </span><span style="color:#c82829;">container_name</span><span>: </span><span style="color:#718c00;">prometheus
</span><span>    </span><span style="color:#c82829;">restart</span><span>: </span><span style="color:#718c00;">unless-stopped
</span><span>    </span><span style="color:#c82829;">command</span><span>:
</span><span>      - </span><span style="color:#718c00;">&#39;--storage.tsdb.retention.time=5y&#39;
</span><span>    </span><span style="color:#c82829;">ports</span><span>:
</span><span>      - </span><span style="color:#718c00;">9090:9090
</span><span>    </span><span style="color:#c82829;">volumes</span><span>:
</span><span>      - </span><span style="color:#718c00;">./prometheus/config:/etc/prometheus
</span><span>      - </span><span style="color:#718c00;">prometheus_data:/prometheus
</span><span>
</span><span style="color:#c82829;">volumes</span><span>:
</span><span>  </span><span style="color:#c82829;">prometheus_data</span><span>:
</span></code></pre>
<ul>
<li>Set a retention period of 5 years. The defualt is 15 days, so I'll specify something longer so I can track historical data.</li>
<li>Map the <code>/etc/prometheus</code> folder so we specify a <code>prometheus.yml</code> file later to configure data sources.</li>
</ul>
<h3 id="grafana-dashboard">Grafana Dashboard</h3>
<p>Grafana is an open-source platform for monitoring and observability, we'll be using it to create our dashboards.</p>
<pre data-lang="yaml" style="background-color:#ffffff;color:#4d4d4c;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#c82829;">services</span><span>:
</span><span>  </span><span style="color:#c82829;">grafana</span><span>:
</span><span>    </span><span style="color:#c82829;">image</span><span>: </span><span style="color:#718c00;">grafana/grafana-enterprise
</span><span>    </span><span style="color:#c82829;">container_name</span><span>: </span><span style="color:#718c00;">grafana
</span><span>    </span><span style="color:#c82829;">restart</span><span>: </span><span style="color:#718c00;">unless-stopped
</span><span>    </span><span style="color:#c82829;">ports</span><span>:
</span><span>      - </span><span style="color:#718c00;">3000:3000
</span><span>    </span><span style="color:#c82829;">environment</span><span>:
</span><span>      - </span><span style="color:#718c00;">GF_SECURITY_ADMIN_USER=admin
</span><span>      - </span><span style="color:#718c00;">GF_SECURITY_ADMIN_PASSWORD=grafana
</span><span>    </span><span style="color:#c82829;">volumes</span><span>:
</span><span>      - </span><span style="color:#718c00;">./grafana/config:/etc/grafana/provisioning/datasources
</span><span>      - </span><span style="color:#718c00;">grafana_data:/var/lib/grafana
</span><span>
</span><span style="color:#c82829;">volumes</span><span>:
</span><span>  </span><span style="color:#c82829;">grafana_data</span><span>:
</span></code></pre>
<ul>
<li>Set a username and password for the dashboard</li>
<li>Map the <code>/etc/grafana/provisioning/datasources</code> folder so we specify a <code>datasources.yml</code> file. We'll be specifying the Prometheus instance as the datasource.</li>
</ul>
<pre data-lang="yaml" style="background-color:#ffffff;color:#4d4d4c;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#c82829;">datasources</span><span>:
</span><span>  - </span><span style="color:#c82829;">name</span><span>: </span><span style="color:#718c00;">Prometheus
</span><span>    </span><span style="color:#c82829;">type</span><span>: </span><span style="color:#718c00;">prometheus
</span><span>    </span><span style="color:#c82829;">access</span><span>: </span><span style="color:#718c00;">proxy
</span><span>    </span><span style="color:#c82829;">url</span><span>: </span><span style="color:#718c00;">http://prometheus:9090
</span><span>    </span><span style="color:#c82829;">isDefault</span><span>: </span><span style="color:#f5871f;">true
</span><span>    </span><span style="color:#c82829;">editable</span><span>: </span><span style="color:#f5871f;">true
</span></code></pre>
<h3 id="data-exporters">Data Exporters</h3>
<p>I'm using <a href="https://hub.docker.com/r/utkuozdemir/nvidia_gpu_exporter/tags">utkuozdemir/nvidia_gpu_exporter</a> to collect analytics from the Nvidia GPU, to measure things likes power consumption. This custom exporter connects to the <code>nvidia-smi</code> tool provided by the standard Nvidia driver. </p>
<p>To expose the Nvidia GPU from the host inside of the docker container, setup <a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html">NVIDIA Container Toolkit</a></p>
<pre data-lang="yaml" style="background-color:#ffffff;color:#4d4d4c;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#c82829;">services</span><span>:
</span><span>  </span><span style="color:#c82829;">nvidia-gpu-exporter</span><span>:
</span><span>    </span><span style="color:#c82829;">image</span><span>: </span><span style="color:#718c00;">utkuozdemir/nvidia_gpu_exporter
</span><span>    </span><span style="color:#c82829;">container_name</span><span>: </span><span style="color:#718c00;">nvidia-gpu-exporter
</span><span>    </span><span style="color:#c82829;">restart</span><span>: </span><span style="color:#718c00;">unless-stopped
</span><span>    </span><span style="color:#c82829;">ports</span><span>:
</span><span>      - </span><span style="color:#718c00;">9835:9835
</span><span>    </span><span style="color:#c82829;">deploy</span><span>:
</span><span>      </span><span style="color:#c82829;">resources</span><span>:
</span><span>        </span><span style="color:#c82829;">reservations</span><span>:
</span><span>          </span><span style="color:#c82829;">devices</span><span>:
</span><span>            - </span><span style="color:#c82829;">driver</span><span>: </span><span style="color:#718c00;">nvidia
</span><span>              </span><span style="color:#c82829;">count</span><span>: </span><span style="color:#718c00;">all
</span><span>              </span><span style="color:#c82829;">capabilities</span><span>: [</span><span style="color:#718c00;">gpu</span><span>]
</span><span>    </span><span style="color:#c82829;">environment</span><span>:
</span><span>      - </span><span style="color:#718c00;">NVIDIA_VISIBLE_DEVICES=all
</span></code></pre>
<p>Nvidia provides their own Prometheus exporter <a href="https://github.com/NVIDIA/dcgm-exporter">dcgm-exporter</a>, NVIDIA Data Center GPU Manager (DCGM) is targeted more at enterprise use. It is more complicated to setup than the custom exporter, and actually reports less metrics than the <code>nvidia-smi</code> based exporter.</p>
<p>I'm using <a href="https://github.com/HON95/prometheus-ethermine-exporter">hon95/prometheus-ethermine-exporter</a> to collect analytic from the <a href="https://ethermine.org/">ethermine</a> etherium mining pool.</p>
<pre data-lang="yaml" style="background-color:#ffffff;color:#4d4d4c;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#c82829;">services</span><span>:
</span><span>  </span><span style="color:#c82829;">ethermine-exporter</span><span>:
</span><span>    </span><span style="color:#c82829;">image</span><span>: </span><span style="color:#718c00;">hon95/prometheus-ethermine-exporter
</span><span>    </span><span style="color:#c82829;">environment</span><span>:
</span><span>      - </span><span style="color:#718c00;">TZ=America/Toronto
</span><span>    </span><span style="color:#c82829;">ports</span><span>:
</span><span>      - </span><span style="color:#718c00;">8080:8080
</span></code></pre>
<p>In my instance the data exporters are running on mining system itself. This is a seperate host than where the Prometheus and Grafana contianers are running. </p>
<h3 id="configuring-prometheus-yml">Configuring <code>prometheus.yml</code></h3>
<p>We'll need to specify a configurtation file for Prometheus to scrape data from the exporters.</p>
<pre data-lang="yaml" style="background-color:#ffffff;color:#4d4d4c;" class="language-yaml "><code class="language-yaml" data-lang="yaml"><span style="color:#c82829;">global</span><span>:
</span><span>  </span><span style="color:#c82829;">scrape_interval</span><span>: </span><span style="color:#718c00;">60s
</span><span>  </span><span style="color:#c82829;">scrape_timeout</span><span>: </span><span style="color:#718c00;">10s
</span><span>
</span><span style="color:#c82829;">scrape_configs</span><span>:
</span><span>  - </span><span style="color:#c82829;">job_name</span><span>: </span><span style="color:#718c00;">&#39;prometheus&#39;
</span><span>    </span><span style="color:#c82829;">static_configs</span><span>:
</span><span>      - </span><span style="color:#c82829;">targets</span><span>: [</span><span style="color:#718c00;">&#39;prometheus:9090&#39;</span><span>]
</span><span>
</span><span>  - </span><span style="color:#c82829;">job_name</span><span>: </span><span style="color:#718c00;">&#39;nvidia-gpu-exporter&#39;
</span><span>    </span><span style="color:#c82829;">static_configs</span><span>:
</span><span>      - </span><span style="color:#c82829;">targets</span><span>: [</span><span style="color:#718c00;">&#39;alex-desktop:9835&#39;</span><span>]
</span><span>
</span><span>  - </span><span style="color:#c82829;">job_name</span><span>: </span><span style="color:#718c00;">ethermine-ethermine-miner
</span><span>    </span><span style="color:#999999;"># Limit due to API rate restriction
</span><span>    </span><span style="color:#c82829;">scrape_interval</span><span>: </span><span style="color:#718c00;">5m
</span><span>    </span><span style="color:#c82829;">metrics_path</span><span>: </span><span style="color:#718c00;">/miner
</span><span>    </span><span style="color:#c82829;">params</span><span>:
</span><span>      </span><span style="color:#c82829;">pool</span><span>: [</span><span style="color:#718c00;">ethermine</span><span>]
</span><span>    </span><span style="color:#c82829;">static_configs</span><span>:
</span><span>      - </span><span style="color:#c82829;">targets</span><span>:
</span><span>          </span><span style="color:#999999;"># TODO List your ETH addresses here
</span><span>          - </span><span style="color:#f5871f;">0000000000000000000000000000000000000000
</span><span>    </span><span style="color:#c82829;">relabel_configs</span><span>:
</span><span>      - </span><span style="color:#c82829;">source_labels</span><span>: [</span><span style="color:#718c00;">__address__</span><span>]
</span><span>        </span><span style="color:#c82829;">target_label</span><span>: </span><span style="color:#718c00;">__param_target
</span><span>      - </span><span style="color:#c82829;">source_labels</span><span>: [</span><span style="color:#718c00;">__param_target</span><span>]
</span><span>        </span><span style="color:#c82829;">target_label</span><span>: </span><span style="color:#718c00;">instance
</span><span>      - </span><span style="color:#c82829;">target_label</span><span>: </span><span style="color:#718c00;">__address__
</span><span>        </span><span style="color:#999999;"># TODO Point this to your exporter
</span><span>        </span><span style="color:#c82829;">replacement</span><span>: </span><span style="color:#718c00;">alex-desktop:8080
</span></code></pre>
<h2 id="validate-setup">Validate Setup</h2>
<p>Visit http://server-ip:9090/targets to verfiy that Prometheus can reach the the exporters.</p>
<p><img src="/images/crypto-mining-dashboard-prometheus-targets.png" alt="Prometheus Targets" /></p>
<p>The targets page shows all exporters as &quot;UP&quot; with recent successful scrapes, indicating the data pipeline is functioning correctly. </p>
<p>Go to the Query tab and see that data is flowing into Prometheus.</p>
<p><img src="/images/crypto-mining-dashboard-prometheus-query.png" alt="Prometheus Query" /></p>
<p>The Prometheus query interface enables ad-hoc analysis for troubleshooting and optimization. This useful for exploring different data metrics before building out vizualizations.</p>
<p>I've setup a simple dashboard to display the GPU hashrate, power consumption, valid shares, and unpaid balance. </p>
<p><img src="/images/crypto-mining-dashboard-grafana.png" alt="Grafana Dashboard" /></p>
<p>The dashboard demonstrates several design principles that emerged during development. The gauge visualizations provide immediate status awareness with color coding for normal, warning, and critical states. The time-series graphs reveal trends over several days, which proved essential for identifying gradual degradation or improvement patterns.</p>
<p>Having GPU metrics and pool statistics on the same dashboard allows quick correlation between equipment performance and earnings. The steady trends in both hashrate and power consumption indicate consistent mining operation.</p>
<h2 id="through-data-analysis-and-performance-optimization">Through Data Analysis and Performance Optimization</h2>
<p>The most rewarding aspect of this project was using the collected data to optimize mining operations. The correlation between power consumption and hashrate revealed optimal operating points that weren't obvious. The data showed that running the 1080 Ti at slightly reduced power limits often provided better efficiency without significantly impacting output.</p>
<h2 id="lessons-learned">Lessons Learned</h2>
<p>Building this monitoring system taught valuable lessons about data pipeline design and operations. Starting with simple, reliable components and gradually adding complexity worked better than trying to build everything at once. The Docker Compose approach provided good isolation and reproducibility, making the system easy to replicate or modify.</p>
<p>This project demonstrated how comprehensive monitoring transforms operations from reactive maintenance to proactive optimization. The investment in building robust data collection and analysis capabilities pays dividends through improved efficiency, reduced downtime, and better decision-making based on actual performance data rather than assumptions.</p>


    </div>
  </section>
</body>

</html>